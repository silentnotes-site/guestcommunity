<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Guest Community</title>
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;700&display=swap" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/gsap@3.12.2/dist/gsap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/tsparticles@3.1.1/tsparticles.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<style>
  * {
    margin: 0; padding: 0; box-sizing: border-box;
  }
  body {
    font-family: 'Outfit', sans-serif;
    background: linear-gradient(to right, #0f0c29, #302b63, #24243e);
    color: #fff;
    overflow-x: hidden;
  }
  header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem 3rem;
    background: rgba(0,0,0,0.5);
    backdrop-filter: blur(5px);
    z-index: 1000;
    position: fixed;
    top: 0; left: 0; width: 100%;
  }
  header h1 {
    font-size: 1.8rem;
    font-weight: 700;
    color: #fff;
    cursor: pointer;
  }
  nav {
    display: flex;
    gap: 1.5rem;
  }
  nav a {
    color: #ccc;
    text-decoration: none;
    font-weight: 600;
    cursor: pointer;
    transition: 0.3s;
    position: relative;
  }
  nav a::after {
    content: "";
    position: absolute;
    bottom: -5px; left: 0;
    width: 0; height: 2px;
    background: #25d366;
    transition: width 0.3s ease;
  }
  nav a:hover::after,
  nav a.active::after {
    width: 100%;
  }
  nav a:hover, nav a.active {
    color: #fff;
  }
  main {
    padding-top: 100px;
    min-height: 80vh;
  }
  section {
    display: none;
    padding: 2rem 3rem;
    text-align: center;
  }
  section.active {
    display: block;
  }
  h2 {
    margin-bottom: 1rem;
  }
  button.join-btn {
    background: #25d366;
    color: #fff;
    padding: 1rem 2rem;
    border: none;
    font-size: 1.2rem;
    border-radius: 30px;
    cursor: pointer;
    transition: 0.3s ease;
    box-shadow: 0 6px 15px #25d366aa;
    margin-bottom: 1rem;
  }
  button.join-btn:hover {
    background: #1ebc59;
    transform: scale(1.05);
    box-shadow: 0 8px 20px #1ebc59dd;
  }
  #particles-js {
    position: fixed;
    top: 0; left: 0;
    height: 100%;
    width: 100%;
    z-index: -1;
  }
  footer {
    text-align: center;
    padding: 2rem;
    background: #101020;
    font-size: 0.9rem;
    color: #aaa;
  }
  .loading {
    font-style: italic;
    opacity: 0.8;
  }
  .error {
    color: #ff6666;
    font-weight: 700;
  }
  ul.news-list {
    list-style: none;
    max-width: 700px;
    margin: 0 auto;
    text-align: left;
    padding: 0;
  }
  ul.news-list li {
    margin-bottom: 15px;
    border-bottom: 1px solid #444;
    padding-bottom: 10px;
  }
  ul.news-list li a {
    color: #25d366;
    text-decoration: none;
  }
  ul.news-list li a:hover {
    text-decoration: underline;
  }
</style>
</head>
<body>
<div id="particles-js"></div>

<header>
  <h1 id="logo">Guest Community</h1>
  <nav>
    <a class="nav-link active" data-section="home">Home</a>
    <a class="nav-link" data-section="meteo">Meteo</a>
    <a class="nav-link" data-section="notizie">Notizie</a>
    <a class="nav-link" data-section="quote">Quote</a>
    <a class="nav-link" data-section="ora">Ora</a>
  </nav>
</header>

<main>
  <section id="home" class="active">
    <h2>Benvenuto nella Guest Community</h2>
    <p>Unisciti al nostro gruppo WhatsApp esclusivo per condividere idee, risorse e nuove esperienze.</p>
    <button class="join-btn" id="join-btn">Unisciti al gruppo</button>
  </section>

  <section id="meteo">
    <h2>Meteo in tempo reale</h2>
    <p id="meteo-info" class="loading">Caricamento meteo...</p>
  </section>

  <section id="notizie">
    <h2>Ultime notizie</h2>
    <input type="text" id="news-search" placeholder="Cerca notizie (es: tecnologia)" style="padding:0.5rem; border-radius:6px; border:none; max-width: 300px; margin-bottom: 1rem;" />
    <p id="news-info" class="loading">Caricamento notizie...</p>
    <ul class="news-list" id="news-list"></ul>
  </section>

  <section id="quote">
    <h2>Citazione motivazionale</h2>
    <p id="quote-text" class="loading">Caricamento citazione...</p>
    <button class="join-btn" id="new-quote-btn">Nuova citazione</button>
  </section>

  <section id="ora">
    <h2>Ora attuale</h2>
    <p id="time-info" class="loading">Caricamento ora...</p>
    <p id="timezone-info"></p>
  </section>
</main>

<footer>
  © 2025 Guest Community • Powered by WebMagix
</footer>

<script>
  tsParticles.load("particles-js", {
    fullScreen: { enable: true },
    particles: {
      number: { value: 80 },
      size: { value: 4 },
      move: { enable: true, speed: 1.8 },
      links: { enable: true, color: "#25d366" },
      color: { value: "#25d366" },
      interactivity: {
        events: {
          onHover: { enable: true, mode: "repulse" },
          onClick: { enable: true, mode: "push" }
        },
        modes: {
          repulse: { distance: 100 },
          push: { quantity: 4 }
        }
      }
    }
  });

  function joinWhatsApp() {
    Swal.fire({
      title: "Unisciti a Guest Community",
      text: "Vuoi entrare nel gruppo WhatsApp?",
      icon: "question",
      showCancelButton: true,
      confirmButtonText: "Sì, vai al gruppo",
      cancelButtonText: "Annulla"
    }).then(result => {
      if(result.isConfirmed) {
        window.location.href = "https://chat.whatsapp.com/YOUR_LINK";
      }
    });
  }
  document.getElementById("join-btn").addEventListener("click", joinWhatsApp);

  const navLinks = document.querySelectorAll(".nav-link");
  const sections = document.querySelectorAll("main section");
  navLinks.forEach(link => {
    link.addEventListener("click", () => {
      navLinks.forEach(l => l.classList.remove("active"));
      link.classList.add("active");
      const target = link.getAttribute("data-section");
      sections.forEach(sec => {
        if(sec.id === target) {
          sec.classList.add("active");
          gsap.fromTo(sec, {opacity:0, y:30}, {opacity:1, y:0, duration:0.5, ease:"power3.out"});
        } else {
          sec.classList.remove("active");
        }
      });
    });
  });

  async function fetchMeteo() {
    const info = document.getElementById("meteo-info");
    try {
      if (!navigator.geolocation) throw "Geolocalizzazione non supportata";
      navigator.geolocation.getCurrentPosition(async pos => {
        const lat = pos.coords.latitude.toFixed(2);
        const lon = pos.coords.longitude.toFixed(2);
        const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true&temperature_unit=celsius&windspeed_unit=kmh&timezone=auto`;
        const res = await fetch(url);
        if(!res.ok) throw "Errore API meteo";
        const data = await res.json();
        const c = data.current_weather.temperature;
        const w = data.current_weather.weathercode;
        const ws = data.current_weather.windspeed;
        const weatherDesc = weatherCodeToDesc(w);
        info.textContent = `Temperatura: ${c}°C, Condizioni: ${weatherDesc}, Vento: ${ws} km/h`;
      }, () => {
        info.textContent = "Permesso geolocalizzazione negato";
      });
    } catch(e) {
      info.textContent = "Errore nel caricamento meteo";
      info.classList.add("error");
    }
  }
  function weatherCodeToDesc(code) {
    const map = {
      0: "Sereno",
      1: "Parzialmente nuvoloso",
      2: "Nuvoloso",
      3: "Coperto",
      45: "Nebbia",
      48: "Nebbia con depositi di brina",
      51: "Pioggerella leggera",
      53: "Pioggerella moderata",
      55: "Pioggerella intensa",
      61: "Pioggia leggera",
      63: "Pioggia moderata",
      65: "Pioggia intensa",
      71: "Neve leggera",
      73: "Neve moderata",
      75: "Neve intensa",
      80: "Pioggia a rovesci leggeri",
      81: "Pioggia a rovesci moderati",
      82: "Pioggia a rovesci intensi",
      95: "Temporale",
      99: "Temporale con grandine"
    };
    return map[code] || "Condizioni sconosciute";
  }

  async function fetchNotizie(query = "tecnologia") {
    const info = document.getElementById("news-info");
    const list = document.getElementById("news-list");
    info.textContent = "Caricamento notizie...";
    list.innerHTML = "";
    try {
      const res = await fetch(`https://newsapi.org/v2/everything?q=${encodeURIComponent(query)}&language=it&pageSize=5&apiKey=demo`);
      if(!res.ok) throw "Errore API notizie";
      const data = await res.json();
      if(data.articles.length === 0) {
        info.textContent = "Nessuna notizia trovata";
        return;
      }
      info.textContent = "";
      data.articles.forEach(a => {
        const li = document.createElement("li");
        li.innerHTML = `<a href="${a.url}" target="_blank" rel="noopener">${a.title}</a><br><small>${new Date(a.publishedAt).toLocaleDateString()}</small>`;
        list.appendChild(li);
      });
    } catch(e) {
      info.textContent = "Errore nel caricamento notizie";
      info.classList.add("error");
    }
  }

  async function fetchQuote() {
    const quoteEl = document.getElementById("quote-text");
    quoteEl.textContent = "Caricamento citazione...";
    try {
      const res = await fetch("https://quote-garden.herokuapp.com/api/v3/quotes/random");
      if(!res.ok) throw "Errore API quote";
      const data = await res.json();
      quoteEl.textContent = `"${data.data[0].quoteText}" — ${data.data[0].quoteAuthor || "Autore sconosciuto"}`;
    } catch(e) {
      quoteEl.textContent = "Errore nel caricamento citazione";
      quoteEl.classList.add("error");
    }
  }

  async function fetchOra() {
    const timeInfo = document.getElementById("time-info");
    const tzInfo = document.getElementById("timezone-info");
    timeInfo.textContent = "Caricamento ora...";
    tzInfo.textContent = "";
    try {
      const res = await fetch("http://worldtimeapi.org/api/ip");
      if(!res.ok) throw "Errore API ora";
      const data = await res.json();
      const datetime = new Date(data.datetime);
      timeInfo.textContent = datetime.toLocaleTimeString();
      tzInfo.textContent = `Fuso orario: ${data.timezone}`;
    } catch(e) {
      timeInfo.textContent = "Errore nel caricamento ora";
      timeInfo.classList.add("error");
    }
  }

  document.getElementById("new-quote-btn").addEventListener("click", fetchQuote);
  document.getElementById("news-search").addEventListener("keyup", e => {
    if(e.key === "Enter") fetchNotizie(e.target.value || "tecnologia");
  });

  window.onload = () => {
    fetchMeteo();
    fetchNotizie();
    fetchQuote();
    fetchOra();
  };
</script>
</body>
</html>
